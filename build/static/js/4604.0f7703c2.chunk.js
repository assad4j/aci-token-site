"use strict";(self.webpackChunkaci_presale_site=self.webpackChunkaci_presale_site||[]).push([[4604],{54604:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Q});var r=n(9950),o=n(67818),i=n(63309),s=n(44414);const a={emotion:"\u2014",stress:.2,confidence:.6,wpm:null,fillersPerMin:null},l={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_WALLETCONNECT_PROJECT_ID:"TON_PROJECT_ID_ICI",REACT_APP_PRESALE_CONTRACT_ADDRESS:"0x8257194Ae124EDEA0E434a3D1479e52C5a5C59C4",REACT_APP_PRESALE_CHAIN_ID:"1",REACT_APP_PRESALE_MIN_ETH:"0.01",REACT_APP_PRESALE_MAX_ETH:"50",REACT_APP_PRESALE_STATS_ENDPOINT:"",REACT_APP_PRESALE_NETWORK_LABEL:"Ethereum Mainnet",REACT_APP_PRESALE_RPC_URL:"",REACT_APP_ANALYTICS_ID:"",REACT_APP_STAKING_CONTRACT_ADDRESS:"0xF7dc4A9A7d4b3D989295C76E5ace1fA390bb5e03",REACT_APP_STAKING_TOKEN_ADDRESS:"",REACT_APP_STAKING_CHAIN_ID:"1",REACT_APP_STAKING_MIN_AMOUNT:"0",REACT_APP_STAKING_NETWORK_LABEL:"Ethereum Mainnet"}.REACT_APP_AUDIO_AI_URL,c=["euh","heu","uh","hum","hmm"],u={angry:"Col\xe8re",disgusted:"D\xe9go\xfbt",disgust:"D\xe9go\xfbt",fear:"Craintif",fearful:"Craintif",happy:"Joyeux",sad:"Triste",surprise:"Surpris",surprised:"Surpris",neutral:"Neutre",calm:"Calme",bored:"Distrait",sleepy:"Somnolent",serious:"S\xe9rieux",confused:"Perplexe",excited:"Enthousiaste",smile:"Sourire"};function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!e)return null;const t=e.toLowerCase();return u[t]?u[t]:e.charAt(0).toUpperCase()+e.slice(1)}function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(n,Math.max(t,e))}function p(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.25;return null===e||Number.isNaN(e)?t:e*(1-n)+t*n}function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!Number.isFinite(e)||e<0?"\u2014":Number(e).toFixed(t)}function f(e){const t=[];return e.stress>.65&&t.push("Pr\xe9pare un rituel de reset (respiration, ancrage) avant ta prochaine session."),e.confidence<.45&&t.push("\xc9cris ton intention en une phrase cl\xe9 et r\xe9p\xe8te-la \xe0 voix haute avant de d\xe9marrer."),e.fillers>4&&t.push("Pratique un silence conscient : marque une pause d\xe8s que tu sens venir un \u201ceuh\u201d."),e.wpm>110&&t.push("Travaille ton rythme : lis un passage lentement pour t\u2019habituer \xe0 ralentir."),e.confidence>.7&&e.stress<.55&&t.push("Challenge bonus : expose une id\xe9e complexe en 120 secondes lors de la prochaine s\xe9ance."),t.length<3&&t.push("R\xe9p\xe8te la structure \u201cSituation - Action - R\xe9sultat\u201d pour fluidifier ton discours."),t.length<3&&t.push("Installe-toi dans un environnement calme et v\xe9rifie ton mat\xe9riel audio \xe0 l\u2019avance."),t.length<3&&t.push("Hydrate-toi 10 minutes avant la session pour soutenir la qualit\xe9 de ta voix."),t.slice(0,3)}function g(e){let{history:t}=e;const n=(0,r.useMemo)(()=>{if(!t.length)return null;const e=t.length,n=n=>t.map((t,r)=>`${r/(e-1||1)*100},${100-100*t[n]}`).join(" ");return{stress:n("stress"),confidence:n("confidence")}},[t]);return n?(0,s.jsxs)("svg",{viewBox:"0 0 100 100",preserveAspectRatio:"none",className:"h-40 w-full rounded-2xl border border-white/10 bg-black/40 p-2 text-white",children:[(0,s.jsx)("polyline",{points:n.stress,fill:"none",stroke:"rgb(244, 63, 94)",strokeWidth:"2"}),(0,s.jsx)("polyline",{points:n.confidence,fill:"none",stroke:"rgb(16, 185, 129)",strokeWidth:"2"})]}):(0,s.jsx)("div",{className:"h-40 w-full rounded-2xl border border-white/10 bg-black/40 flex items-center justify-center text-white/60",children:"Aucune donn\xe9e disponible pour cette session."})}function x(e){let{label:t,value:n}=e;const r=100*m(n,0,1)+"%";return(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm uppercase text-white/60 tracking-wide",children:[(0,s.jsx)("span",{children:t}),(0,s.jsxs)("span",{children:[h(100*n,0),"%"]})]}),(0,s.jsx)("div",{className:"h-2 rounded-full bg-white/10",children:(0,s.jsx)("div",{className:"h-full rounded-full bg-gradient-to-r from-emerald-400 to-rose-500 transition-all duration-500",style:{width:r}})})]})}function v(){let{onMetricsChange:e,onEmotionStateChange:t,onSessionToggle:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const[i,u]=(0,r.useState)(!1),[v,b]=(0,r.useState)(!1),[A,_]=(0,r.useState)(a),[w,y]=(0,r.useState)([]),[E,C]=(0,r.useState)(null),[T,S]=(0,r.useState)(null),[P,N]=(0,r.useState)(!1),[R,k]=(0,r.useState)(null),[j,I]=(0,r.useState)("idle"),[D,L]=(0,r.useState)(null),[O,M]=(0,r.useState)(null),[K,F]=(0,r.useState)(null),H=(0,r.useRef)([]),U=(0,r.useRef)(null),q=(0,r.useRef)({counts:{},lastTimestamp:0,total:0}),W=(0,r.useRef)(null),G=(0,r.useRef)(null),B=(0,r.useRef)(null),V=(0,r.useRef)(null),J=(0,r.useMemo)(()=>"undefined"!==typeof window&&("SpeechRecognition"in window||"webkitSpeechRecognition"in window),[]),$=(0,r.useMemo)(()=>{var e,t;const n=m(null!==(e=null===A||void 0===A?void 0:A.stress)&&void 0!==e?e:0,0,1),r=m(null!==(t=null===A||void 0===A?void 0:A.confidence)&&void 0!==t?t:.5,0,1),o=function(e){if(!e)return"neutral";const t=e.toString().toLowerCase();return t.includes("jo")||t.includes("heureux")||t.includes("sour")?"joy":t.includes("calm")||t.includes("zen")?"calm":t.includes("stress")||t.includes("tendu")||t.includes("ango")||t.includes("peur")?"stress":t.includes("trist")||t.includes("fatigu")?"sad":t.includes("col\xe8r")||t.includes("anger")||t.includes("rage")?"anger":t.includes("confian")?"confident":t.includes("enthous")||t.includes("excited")?"excited":(t.includes("neutre"),"neutral")}(null===A||void 0===A?void 0:A.emotion),i=Number.isFinite(null===A||void 0===A?void 0:A.wpm)?A.wpm:null,s=null!=i?m((i-60)/80,0,1):.45,a=m(.6*s+.4*n,0,1);return{emotion:o,stressScore:n,valence:m(.5+.5*(r-n),0,1),arousal:a,confidence:r}},[A]),z=(0,r.useRef)(null),X=(0,r.useRef)(null),Y=(0,r.useRef)(null),Q=(0,r.useRef)(null),Z=(0,r.useRef)({totalWords:0,fillerCount:0,estimatedWords:0}),ee=(0,r.useRef)({wasSpeaking:!1,burstCount:0,volumeHistory:[],speakingSamples:0,totalSamples:0}),te=(0,r.useRef)({energy:null,pitch:null}),ne=(0,r.useRef)(0),re=(0,r.useRef)(null),oe=(0,r.useRef)(null),ie=(0,r.useRef)(!1),se=(0,r.useCallback)(()=>{q.current={counts:{},lastTimestamp:0,total:0},U.current=null,L(null)},[]),ae=(0,r.useCallback)(async()=>{if(W.current)return W.current;if("undefined"===typeof window)return null;try{const e=await n.e(6189).then(n.bind(n,66189)),t=new((null===e||void 0===e?void 0:e.default)||(null===e||void 0===e?void 0:e.Human)||e)({cacheSensitivity:0,modelBasePath:"https://vladmandic.github.io/human/models/",face:{enabled:!0,detector:{rotation:!0,maxDetected:1},mesh:{enabled:!1},attention:{enabled:!1},description:{enabled:!1},iris:{enabled:!1},emotion:{enabled:!0}},hand:{enabled:!1},body:{enabled:!1},gesture:{enabled:!1},segmentation:{enabled:!1},filter:{enabled:!0}});return await t.load(),W.current=t,t}catch(e){return console.error("Impossible de charger Human",e),k("Impossible de charger les mod\xe8les d\u2019analyse vid\xe9o."),N(!1),I("idle"),null}},[N,I]),le=(0,r.useCallback)(()=>{if(B.current&&(cancelAnimationFrame(B.current),B.current=null),G.current){try{G.current.pause()}catch{}G.current.srcObject=null}U.current=null,L(null),I(e=>P||"analysis"===e?"ready":"idle")},[P]),ce=(0,r.useCallback)(e=>{var t;if(!e||!e.label)return U.current=null,void L(null);const n=(e.distribution||[]).map(e=>{var t;return{label:d(e.emotion||e.label||""),score:null!==(t=e.score)&&void 0!==t?t:0}}),r={label:e.label,raw:e.raw||null,score:m(null!==(t=e.score)&&void 0!==t?t:0,0,1),distribution:n};U.current=r,L(r);const o=q.current,i="undefined"!==typeof performance?performance.now():Date.now();(!o.lastTimestamp||i-o.lastTimestamp>900)&&(o.counts[r.label]=(o.counts[r.label]||0)+1,o.total=(o.total||0)+1,o.lastTimestamp=i)},[]),ue=(0,r.useCallback)(async()=>{if(!P||!G.current)return;const e=await ae();if(!e)return;I("analysis");const t=async()=>{if(ie.current)if(!G.current||G.current.readyState<2)B.current=requestAnimationFrame(t);else{try{var n;const t=await e.detect(G.current);if(null!==t&&void 0!==t&&null!==(n=t.face)&&void 0!==n&&n.length){const e=t.face[0].emotion||[];if(e.length){const t=e.reduce((e,t)=>t.score>e.score?t:e,e[0]);ce({label:d(t.emotion||t.label),raw:t.emotion||t.label,score:t.score,distribution:e})}else ce(null)}else ce(null)}catch(r){console.error("Erreur lors de la d\xe9tection vid\xe9o",r)}B.current=requestAnimationFrame(t)}};B.current=requestAnimationFrame(t)},[ae,ce,P]),de=(0,r.useCallback)(async()=>{if(!v){if(P)return le(),se(),N(!1),I("idle"),void k(null);if(k(null),"undefined"!==typeof navigator&&navigator.mediaDevices&&"function"===typeof navigator.mediaDevices.getUserMedia){I("checking");try{(await navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user",width:{ideal:640},height:{ideal:480}}})).getTracks().forEach(e=>e.stop()),N(!0),I("ready")}catch(e){console.error(e),k("Acc\xe8s cam\xe9ra refus\xe9. V\xe9rifie les permissions de ton navigateur."),I("idle"),N(!1)}}else k("La cam\xe9ra n\u2019est pas disponible sur ce navigateur.")}},[se,v,le,P]),me=(0,r.useCallback)(()=>{oe.current&&(oe.current.onend=null,oe.current.stop(),oe.current=null)},[]),pe=(0,r.useCallback)(()=>{ie.current=!1,Y.current&&(clearInterval(Y.current),Y.current=null),Q.current&&(Q.current.getTracks().forEach(e=>e.stop()),Q.current=null),z.current&&(z.current.close().catch(()=>{}),z.current=null),X.current=null,re.current=null,te.current={energy:null,pitch:null},ne.current=0,M(null),F(null),le(),me()},[me,le]);(0,r.useEffect)(()=>()=>{pe()},[pe]),(0,r.useEffect)(()=>{if(!v||!P)return;const e=Q.current;if(!e||"function"!==typeof e.getVideoTracks)return;if(!(e.getVideoTracks().length>0))return void I("idle");const t=G.current;if(!t)return;t.srcObject!==e&&(t.srcObject=e),t.muted=!0,t.playsInline=!0;const n=t.play();n&&"function"===typeof n.catch&&n.catch(()=>{}),B.current||ue()},[v,ue,P,I]);const he=async()=>{C(null),k(null),S(null),y([]),H.current=[],_({...a}),se(),I(P?"starting":"idle"),ee.current={wasSpeaking:!1,burstCount:0,volumeHistory:[],speakingSamples:0,totalSamples:0},Z.current={totalWords:0,fillerCount:0,estimatedWords:0,fillersPerMin:null},te.current={energy:null,pitch:null},ne.current=0,M(null),F(null);let e=P;if("undefined"!==typeof navigator&&navigator.mediaDevices&&"function"===typeof navigator.mediaDevices.getUserMedia)try{let n=null;try{n=await navigator.mediaDevices.getUserMedia({audio:!0,video:!!e&&{facingMode:"user",width:{ideal:640},height:{ideal:480}}})}catch(t){if(!e)throw t;console.error("Video capture unavailable, fallback to audio only",t),k("Impossible d\u2019activer la cam\xe9ra. Passage en mode vocal uniquement."),I("idle"),N(!1),e=!1,n=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1})}const r=new(window.AudioContext||window.webkitAudioContext);if("suspended"===r.state)try{await r.resume()}catch{}const o=r.createAnalyser();o.fftSize=2048;r.createMediaStreamSource(n).connect(o),z.current=r,X.current=o,Q.current=n,e&&I("starting"),re.current=performance.now(),ie.current=!0,b(!0),(()=>{if(!J)return;const e=new(window.SpeechRecognition||window.webkitSpeechRecognition);e.lang="fr-FR",e.continuous=!0,e.interimResults=!0,e.onresult=e=>{let t="";for(let n=e.resultIndex;n<e.results.length;n+=1){const r=e.results[n];r.isFinal&&(t+=r[0].transcript)}if(t){const e=t.toLowerCase().replace(/[^a-z\xe0\xe2\xe7\xe9\xe8\xea\xeb\xee\xef\xf4\xfb\xf9\xfc\xff\xf1\xe6\u0153\s]/gi," ").split(/\s+/).filter(Boolean),n=e.filter(e=>c.includes(e));Z.current.totalWords+=e.length,Z.current.fillerCount+=n.length}},e.onerror=e=>{console.warn("Speech recognition error",e.error)},e.onend=()=>{if(ie.current)try{e.start()}catch(E){console.warn("Unable to restart recognition",E)}},e.start(),oe.current=e})(),ve()}catch(n){console.error(n),C("Analyse indisponible. V\xe9rifie que le micro est bien accessible."),pe(),b(!1)}else C("Le microphone n\u2019est pas disponible sur ce navigateur.")},fe=()=>{var e;if(!X.current)return null;const t=X.current,n=t.fftSize,r=new Float32Array(n);t.getFloatTimeDomainData(r);let o=0;for(let m=0;m<n;m+=1)o+=r[m]*r[m];const i=Math.sqrt(o/n),s=m(i/.15,0,1),a=function(e,t){if(!e||0===e.length)return null;const n=1024,r=Math.min(1023,1023);let o=-1,i=0,s=0;for(let m=0;m<n;m+=1){const t=e[m];s+=t*t}if(s=Math.sqrt(s/n),s<.01)return null;let a=1;const l=new Array(r).fill(0);let c=!1;for(let m=2;m<r;m+=1){let s=0;for(let t=0;t<n;t+=1)s+=Math.abs(e[t]-e[t+m]);if(s=1-s/n,l[m]=s,s>.9&&s>a)c=!0,s>i&&(i=s,o=m);else if(c){var u,d;return o>1&&o<r-1?t/(o+(((null!==(u=l[o+1])&&void 0!==u?u:l[o])-(null!==(d=l[o-1])&&void 0!==d?d:l[o]))/(2*l[o])||0)):t/o}a=s}return i>.01&&o>0?t/o:null}(r,(null===(e=z.current)||void 0===e?void 0:e.sampleRate)||44100),l=ee.current;l.volumeHistory.push(s),l.volumeHistory.length>120&&l.volumeHistory.shift();const c=s>.12;c&&!l.wasSpeaking&&(l.burstCount+=1),l.wasSpeaking=c,l.speakingSamples+=c?1:0,l.totalSamples+=1;const u=l.volumeHistory.reduce((e,t)=>e+t,0)/l.volumeHistory.length,d=l.volumeHistory.reduce((e,t)=>e+(t-u)**2,0)/Math.max(1,l.volumeHistory.length-1);if(!J){const e=3.2*l.burstCount;Z.current.estimatedWords=e}return{normalizedVolume:s,variance:d,speakingRatio:l.speakingSamples/Math.max(1,l.totalSamples),pitch:a,rms:i}},ge=(0,r.useCallback)(e=>{if(!e)return{stress:.35,confidence:.55};const t=te.current;null==t.energy?(t.energy=e.rms,t.pitch=e.pitch||180):(t.energy=.98*t.energy+.02*e.rms,e.pitch&&(t.pitch=.97*t.pitch+.03*e.pitch));const n=e.rms-(t.energy||e.rms),r=e.pitch&&t.pitch?(e.pitch-t.pitch)/Math.max(1,t.pitch):0,o=e.speakingRatio,i=e.variance;let s=m(.3+6*n+.6*i+2*r,0,1),a=m(.5+.6*(o-.4)-.25*i-1.2*n,0,1);if(Number.isFinite(Z.current.fillersPerMin)){const e=Z.current.fillersPerMin;s+=m(.05*e,0,.2),a-=m(.04*e,0,.2)}return{stress:m(s,0,1),confidence:m(a,0,1)}},[]),xe=(0,r.useCallback)(async e=>{if(!l||!e)return;const t=performance.now();if(!(t-ne.current<5e3)){ne.current=t;try{const t={rms:e.rms,variance:e.variance,speakingRatio:e.speakingRatio,pitch:e.pitch,fillersPerMin:Number.isFinite(Z.current.fillersPerMin)?Z.current.fillersPerMin:null},n=await fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`audio_ai_${n.status}`);const r=await n.json();r&&"object"===typeof r&&(M({summary:r.summary||null,stress:"number"===typeof r.stress?m(r.stress,0,1):null,confidence:"number"===typeof r.confidence?m(r.confidence,0,1):null,source:"ai",timestamp:performance.now()}),F(null))}catch(E){console.warn("[emotion/audio] ai analysis failed",E),F("AI voice analysis unavailable, falling back to local metrics.")}}},[F,M]),ve=()=>{Y.current&&clearInterval(Y.current),Y.current=setInterval(()=>{const e=fe();if(!re.current)return;if(!e&&!U.current)return;const t=performance.now()-re.current,n=Math.max(t/6e4,1/60),r=Z.current.totalWords||Z.current.estimatedWords||0,o=Z.current.fillerCount,i=r/n,s=o/n;Z.current.fillersPerMin=Number.isFinite(s)?s:null;const a=e||{normalizedVolume:.15,variance:.04,speakingRatio:.45,rms:.05},l=ge(a),c=m(.25+.6*a.normalizedVolume+.2*a.variance,0,1),u=m(.4+.35*a.speakingRatio-.15*a.variance+.35*(1-c),0,1),d=m(.6*l.stress+.4*c,0,1),h=m(.6*l.confidence+.4*u,0,1);xe(a),_(e=>{var n,r,o;let a=p(null!==(n=e.stress)&&void 0!==n?n:.2,d,.22),l=p(null!==(r=e.confidence)&&void 0!==r?r:.6,h,.22);const c=U.current?function(e){if(null===e||void 0===e||!e.label)return null;const{label:t,score:n=.5}=e,r=m(n,.15,1),o=t.toLowerCase();let i=.5,s=.5;return["col\xe8re","stress\xe9","tendu","craintif","d\xe9go\xfbt"].some(e=>o.includes(e))?(i=.75,s=.35):["triste","perplexe","distra","somnolent"].some(e=>o.includes(e))?(i=.6,s=.3):["surpris","surprise"].some(e=>o.includes(e))?(i=.55,s=.55):["joie","joyeux","enthousias","sourire","calme","neutre"].some(e=>o.includes(e))?(i=.3,s=.72):(i=.48,s=.5),{stress:m(i*r+.5*(1-r),0,1),confidence:m(s*r+.5*(1-r),0,1)}}(U.current):null;c&&(a=p(a,c.stress,.35),l=p(l,c.confidence,.35));const u=V.current;u&&("number"===typeof u.stress&&(a=p(a,m(u.stress,0,1),.2)),"number"===typeof u.confidence&&(l=p(l,m(u.confidence,0,1),.2)));const f=(null===(o=U.current)||void 0===o?void 0:o.label)||function(e,t){return e>.75?"Stress\xe9":t>.72&&e<.55?"Confiant":e<.32&&t>=.5?"Calme":t<.35&&e>.5?"Tendu":"Concentr\xe9"}(a,l),g={emotion:f,stress:a,confidence:l,wpm:Number.isFinite(i)?i:null,fillersPerMin:Number.isFinite(s)?s:null};return y(e=>{const n=[...e,{time:t/1e3,stress:a,confidence:l,wpm:g.wpm,fillers:g.fillersPerMin}];return n.length>180&&n.shift(),H.current=n,n}),g}),M(e=>{var t,n;if("ai"===(null===e||void 0===e?void 0:e.source)&&"number"===typeof e.timestamp&&performance.now()-e.timestamp<6e3)return e;const r=Math.abs((null!==(t=null===e||void 0===e?void 0:e.stress)&&void 0!==t?t:0)-d),o=Math.abs((null!==(n=null===e||void 0===e?void 0:e.confidence)&&void 0!==n?n:0)-h);return"local"===(null===e||void 0===e?void 0:e.source)&&r<.03&&o<.03?e:{summary:(i=d,s=h,l=a.pitch,Number.isFinite(i)&&Number.isFinite(s)?i>.7&&s<.45?"Tension \xe9lev\xe9e d\xe9tect\xe9e : on ralentit et on rel\xe2che les \xe9paules avant de poursuivre.":i>.6&&s>=.45?"Beaucoup d'\xe9nergie ! Canalise-la en clarifiant ce que tu veux exprimer maintenant.":s>.7&&i<.5?"Voix stable et assur\xe9e, parfait pour d\xe9rouler ton plan.":s<.45&&i<.5?"Ton ton est calme mais h\xe9sitant : formule ta prochaine id\xe9e en une phrase forte.":l&&l>280&&i>.5?"La voix monte beaucoup, signe d'\xe9motion. Ralentis et respire pour garder la clart\xe9.":"Voix \xe9quilibr\xe9e : reste sur ce rythme et articule tes id\xe9es principales.":"Je capte ta voix, continue \xe0 parler pour une analyse compl\xe8te."),stress:d,confidence:h,source:"local",timestamp:performance.now()};var i,s,l})},750)},be=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!t.length)return void S(null);const n=t.reduce((e,t)=>(e.stress+=t.stress,e.confidence+=t.confidence,Number.isFinite(t.wpm)&&(e.wpmSum+=t.wpm,e.wpmCount+=1),Number.isFinite(t.fillers)&&(e.fillers+=t.fillers,e.fillersCount+=1),e),{stress:0,confidence:0,wpmSum:0,wpmCount:0,fillers:0,fillersCount:0}),r=t.length,o={stress:n.stress/r,confidence:n.confidence/r,wpm:n.wpmCount?n.wpmSum/n.wpmCount:null,fillers:n.fillersCount?n.fillers/n.fillersCount:null},i=q.current,s=Object.entries((null===i||void 0===i?void 0:i.counts)||{}),a=null!==(e=null===i||void 0===i?void 0:i.total)&&void 0!==e?e:s.reduce((e,t)=>{let[,n]=t;return e+n},0);let l=null;if(s.length&&a>0){const e=[...s].sort((e,t)=>t[1]-e[1]);l={dominant:e[0][0],total:a,distribution:e.slice(0,4).map(e=>{let[t,n]=e;return{label:t,ratio:n/a}})}}S({averages:o,advice:f(o),history:[...t],video:l})},Ae=(0,r.useMemo)(()=>function(e){let{stress:t,confidence:n,fillersPerMin:r,wpm:o}=e;return t>.72||Number.isFinite(r)&&r>6?"On respire 10 secondes, rel\xe2che les \xe9paules et reprends avec un rythme pos\xe9.":n<.4&&Number.isFinite(r)&&r>=3?"Formule un objectif simple en une phrase avant de continuer. \xc7a clarifie le message.":n>.7&&t<.6&&Number.isFinite(o)&&o>=90?"Super \xe9nergie ! Propose-toi un mini-challenge de 2 minutes pour pousser un argument.":n<.45?"Prends 2 inspirations profondes et recentre ton message sur une id\xe9e ma\xeetresse.":"Maintiens ce ton clair. Garde le regard sur ton plan et avance \xe9tape par \xe9tape."}(A),[A]);return(0,r.useEffect)(()=>{V.current=O},[O]),(0,r.useEffect)(()=>{e&&e(A)},[A,e]),(0,r.useEffect)(()=>{t&&t($)},[$,t]),(0,r.useEffect)(()=>{o&&o(v)},[v,o]),(0,s.jsx)("section",{className:"mt-16",children:(0,s.jsxs)("div",{className:"rounded-3xl border border-emerald-500/30 bg-black/70 p-8 shadow-xl shadow-emerald-500/10 backdrop-blur",children:[(0,s.jsxs)("header",{className:"space-y-2 text-white",children:[(0,s.jsx)("p",{className:"text-sm uppercase tracking-[0.3em] text-emerald-300/80",children:"ACI Meta Coach"}),(0,s.jsx)("h2",{className:"text-3xl font-bold md:text-4xl",children:"Module de d\xe9tection d\u2019\xe9motions (voix + cam\xe9ra)"}),(0,s.jsx)("p",{className:"max-w-2xl text-base text-white/70 leading-relaxed",children:"Analyse en direct de la voix pour aider le coach \xe0 adapter ses messages : \xe9motion dominante, niveau de stress, confiance, rythme de parole et h\xe9sitations. Active aussi la cam\xe9ra pour enrichir l\u2019analyse via les expressions faciales (traitement 100% local dans le navigateur)."})]}),(0,s.jsxs)("div",{className:"mt-6 flex flex-wrap items-center gap-4 text-sm text-emerald-200/90",children:[(0,s.jsx)("span",{className:"rounded-full bg-emerald-500/10 px-4 py-1",children:"Analyse vocale active pour mieux t\u2019adapter en temps r\xe9el."}),(0,s.jsxs)("button",{type:"button",onClick:de,disabled:v||"checking"===j,className:`flex items-center gap-2 rounded-full border px-3 py-1 text-white/70 transition ${P?"border-emerald-400/40 bg-emerald-500/10 text-emerald-200 hover:border-emerald-300/60":"border-white/10 hover:border-emerald-400/60 hover:text-emerald-200"} ${v?"cursor-not-allowed opacity-60":"checking"===j?"cursor-progress opacity-60":""}`,title:v?"Arr\xeate la session pour modifier l\u2019analyse vid\xe9o.":P?"D\xe9sactiver l\u2019analyse vid\xe9o":"Activer l\u2019analyse vid\xe9o",children:[(0,s.jsx)("span",{className:"inline-flex h-3 w-6 items-center rounded-full bg-white/10 px-0.5",children:(0,s.jsx)("span",{className:"h-2 w-2 rounded-full transition "+("checking"===j?"bg-amber-300":P?"bg-emerald-400":"bg-white/30")})}),"checking"===j?"Autorisation cam\xe9ra...":P?"Analyse vid\xe9o activ\xe9e":"Activer l\u2019analyse vid\xe9o"]})]}),!i&&(0,s.jsxs)("div",{className:"mt-8 rounded-2xl border border-white/10 bg-white/5 p-6 text-white",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Consentement requis"}),(0,s.jsx)("p",{className:"mt-2 text-sm text-white/70",children:"Pour lancer la d\xe9tection d\u2019\xe9motions, autorise l\u2019acc\xe8s au microphone. Le flux audio reste local, seules les m\xe9triques calcul\xe9es sont affich\xe9es."}),(0,s.jsx)("button",{onClick:async()=>{if(C(null),"undefined"!==typeof navigator&&navigator.mediaDevices&&"function"===typeof navigator.mediaDevices.getUserMedia)try{(await navigator.mediaDevices.getUserMedia({audio:!0,video:!1})).getTracks().forEach(e=>e.stop()),u(!0)}catch(e){console.error(e),C("Impossible d\u2019acc\xe9der au microphone. V\xe9rifie les permissions de ton navigateur.")}else C("Le microphone n\u2019est pas disponible sur ce navigateur.")},className:"mt-4 inline-flex items-center justify-center rounded-full bg-emerald-500 px-6 py-2 text-sm font-semibold text-black transition hover:bg-emerald-400",children:"Autoriser l\u2019analyse vocale"}),E&&(0,s.jsx)("p",{className:"mt-3 text-sm text-rose-300",children:E})]}),i&&!v&&(0,s.jsxs)("div",{className:"mt-8 rounded-2xl border border-white/10 bg-white/5 p-6 text-white space-y-4",children:[(0,s.jsx)("p",{className:"text-sm text-white/70",children:"Tout est pr\xeat pour une session voix. Clique sur d\xe9marrer et parle comme en situation r\xe9elle. Tu peux stopper \xe0 tout moment pour consulter le bilan de fin de session."}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,s.jsx)("button",{onClick:he,className:"inline-flex items-center justify-center rounded-full bg-emerald-500 px-6 py-2 text-sm font-semibold text-black transition hover:bg-emerald-400",children:"Commencer une session"}),(0,s.jsx)("button",{onClick:de,disabled:"checking"===j,className:`inline-flex items-center justify-center rounded-full px-6 py-2 text-sm font-semibold transition ${P?"border border-emerald-400/40 bg-emerald-500/10 text-emerald-200 hover:border-emerald-300/60":"border border-white/20 text-white/70 hover:border-emerald-400/60 hover:text-emerald-200"} ${"checking"===j?"opacity-60 cursor-not-allowed":""}`,children:P?"ready"===j?"Cam\xe9ra pr\xeate":"Cam\xe9ra activ\xe9e":"checking"===j?"Autorisation cam\xe9ra...":"Activer la cam\xe9ra"})]}),T&&(0,s.jsx)("p",{className:"text-xs text-white/50",children:"R\xe9sultat pr\xe9c\xe9dent disponible plus bas."}),E&&(0,s.jsx)("p",{className:"mt-2 text-sm text-rose-300",children:E}),R&&(0,s.jsx)("p",{className:"text-xs text-rose-300",children:R})]}),v&&(0,s.jsxs)("div",{className:"mt-8 grid gap-8 lg:grid-cols-[1.4fr,1fr]",children:[(0,s.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-6 text-white space-y-6",children:[(P||D)&&(0,s.jsxs)("div",{className:"relative overflow-hidden rounded-2xl border border-white/10 bg-black/60",children:[(0,s.jsx)("video",{ref:G,autoPlay:!0,muted:!0,playsInline:!0,className:"block h-full min-h-[220px] w-full object-cover"}),(0,s.jsx)("div",{className:"absolute inset-x-0 bottom-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent p-4 text-sm text-white",children:null!==D&&void 0!==D&&D.label?(0,s.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,s.jsx)("span",{className:"text-base font-semibold",children:D.label}),(0,s.jsxs)("span",{className:"text-xs text-white/60",children:[(100*D.score).toFixed(0),"% confiance"]})]}):(0,s.jsx)("span",{className:"text-xs text-white/60",children:"analysis"===j?"Analyse vid\xe9o en cours...":"Cam\xe9ra pr\xeate, maintien ton visage face \xe0 l\u2019objectif."})})]}),(0,s.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2",children:[(0,s.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-black/40 p-4",children:[(0,s.jsx)("p",{className:"text-xs uppercase text-white/50 tracking-wide",children:"\xc9motion"}),(0,s.jsx)("p",{className:"mt-2 text-2xl font-semibold text-white",children:A.emotion})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-black/40 p-4",children:[(0,s.jsx)("p",{className:"text-xs uppercase text-white/50 tracking-wide",children:"Vitesse de parole"}),(0,s.jsxs)("p",{className:"mt-2 text-2xl font-semibold text-white",children:[h(A.wpm,0)," ",(0,s.jsx)("span",{className:"text-sm text-white/60",children:"mots/min"})]})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-black/40 p-4",children:[(0,s.jsx)("p",{className:"text-xs uppercase text-white/50 tracking-wide",children:"\u201cEuh\u201d par minute"}),(0,s.jsx)("p",{className:"mt-2 text-2xl font-semibold text-white",children:h(A.fillersPerMin,1)})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-black/40 p-4",children:[(0,s.jsx)("p",{className:"text-xs uppercase text-white/50 tracking-wide",children:"Analyse vocale IA"}),(0,s.jsx)("p",{className:"mt-2 text-sm text-white/70 leading-relaxed",children:null!==O&&void 0!==O&&O.summary?O.summary:K||"Je mesure ton ton, ton \xe9nergie et ta stabilit\xe9 pour ajuster ton coaching en direct."})]})]}),(0,s.jsx)(x,{label:"Stress",value:A.stress}),(0,s.jsx)(x,{label:"Confiance",value:A.confidence}),(0,s.jsxs)("div",{className:"rounded-2xl border border-emerald-500/30 bg-emerald-500/10 p-4 text-white",children:[(0,s.jsx)("p",{className:"text-xs uppercase text-emerald-200 tracking-wide",children:"Coach"}),(0,s.jsx)("p",{className:"mt-2 text-base leading-relaxed text-emerald-50",children:Ae})]})]}),(0,s.jsxs)("div",{className:"flex flex-col justify-between rounded-2xl border border-white/10 bg-white/5 p-6 text-white",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm uppercase text-white/60 tracking-wide",children:"Session en cours"}),(0,s.jsx)("p",{className:"text-base text-white/70",children:"Les m\xe9triques sont mises \xe0 jour toutes les 750 ms pour garder un affichage fluide."}),R&&(0,s.jsx)("p",{className:"text-xs text-rose-300",children:R}),K&&(0,s.jsx)("p",{className:"text-xs text-amber-300",children:K})]}),(0,s.jsx)("button",{onClick:()=>function(){let{withSummary:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(b(!1),pe(),e){const e=H.current;e.length&&be(e)}}(),className:"mt-6 inline-flex items-center justify-center rounded-full bg-rose-500 px-6 py-2 text-sm font-semibold text-black transition hover:bg-rose-400",children:"Arr\xeater et afficher le bilan"})]})]}),T&&(0,s.jsxs)("div",{className:"mt-10 rounded-3xl border border-white/10 bg-white/5 p-6 text-white space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,s.jsx)("h3",{className:"text-2xl font-semibold",children:"Bilan de la session"}),(0,s.jsxs)("span",{className:"text-sm text-white/60",children:["Stress (rose) \u2022 Confiance (vert) sur ",T.history.length," points"]})]}),(0,s.jsx)(g,{history:T.history}),(0,s.jsxs)("div",{className:"grid gap-4 sm:grid-cols-3",children:[(0,s.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-black/40 p-4",children:[(0,s.jsx)("p",{className:"text-xs uppercase text-white/50 tracking-wide",children:"Stress moyen"}),(0,s.jsxs)("p",{className:"mt-2 text-xl font-semibold text-white",children:[h(100*T.averages.stress,0),"%"]})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-black/40 p-4",children:[(0,s.jsx)("p",{className:"text-xs uppercase text-white/50 tracking-wide",children:"Confiance moyenne"}),(0,s.jsxs)("p",{className:"mt-2 text-xl font-semibold text-white",children:[h(100*T.averages.confidence,0),"%"]})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-black/40 p-4",children:[(0,s.jsx)("p",{className:"text-xs uppercase text-white/50 tracking-wide",children:"Rythme global"}),(0,s.jsxs)("p",{className:"mt-2 text-xl font-semibold text-white",children:[h(T.averages.wpm,0)," mots/min"]})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-black/40 p-4 sm:col-span-3",children:[(0,s.jsx)("p",{className:"text-xs uppercase text-white/50 tracking-wide",children:"\u201cEuh\u201d moyen"}),(0,s.jsxs)("p",{className:"mt-2 text-xl font-semibold text-white",children:[h(T.averages.fillers,1)," par minute"]})]}),T.video&&(0,s.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-black/40 p-4 sm:col-span-3",children:[(0,s.jsx)("p",{className:"text-xs uppercase text-white/50 tracking-wide",children:"\xc9motions visuelles d\xe9tect\xe9es"}),(0,s.jsxs)("div",{className:"mt-2 flex flex-wrap items-center gap-3 text-sm text-white/80",children:[(0,s.jsxs)("span",{className:"rounded-full bg-white/10 px-3 py-1",children:["Dominante : ",T.video.dominant]}),T.video.distribution.map(e=>(0,s.jsxs)("span",{className:"rounded-full border border-white/10 px-3 py-1",children:[e.label," \xb7 ",h(100*e.ratio,0),"%"]},e.label))]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm uppercase text-white/60 tracking-wide",children:"3 conseils pour la prochaine fois"}),(0,s.jsx)("ul",{className:"mt-3 space-y-2 text-sm text-white/80",children:T.advice.map((e,t)=>(0,s.jsx)("li",{className:"rounded-2xl border border-white/10 bg-black/40 p-3",children:e},t))})]}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,s.jsx)("button",{onClick:he,className:"inline-flex items-center justify-center rounded-full bg-emerald-500 px-6 py-2 text-sm font-semibold text-black transition hover:bg-emerald-400",children:"Relancer une session"}),(0,s.jsx)("p",{className:"text-xs text-white/50",children:"Les donn\xe9es restent c\xf4t\xe9 navigateur. Relance la d\xe9tection quand tu veux."})]})]})]})})}var b=n(35218),A=n(52111),_=n(24039),w=n(42342),y=n(75741),E=n(68057),C=n(13437);const T={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_WALLETCONNECT_PROJECT_ID:"TON_PROJECT_ID_ICI",REACT_APP_PRESALE_CONTRACT_ADDRESS:"0x8257194Ae124EDEA0E434a3D1479e52C5a5C59C4",REACT_APP_PRESALE_CHAIN_ID:"1",REACT_APP_PRESALE_MIN_ETH:"0.01",REACT_APP_PRESALE_MAX_ETH:"50",REACT_APP_PRESALE_STATS_ENDPOINT:"",REACT_APP_PRESALE_NETWORK_LABEL:"Ethereum Mainnet",REACT_APP_PRESALE_RPC_URL:"",REACT_APP_ANALYTICS_ID:"",REACT_APP_STAKING_CONTRACT_ADDRESS:"0xF7dc4A9A7d4b3D989295C76E5ace1fA390bb5e03",REACT_APP_STAKING_TOKEN_ADDRESS:"",REACT_APP_STAKING_CHAIN_ID:"1",REACT_APP_STAKING_MIN_AMOUNT:"0",REACT_APP_STAKING_NETWORK_LABEL:"Ethereum Mainnet"}.REACT_APP_AVATAR_GLTF||null;function S(e){let{gltfPath:t,mouthOpen:n,mood:o,onLoaded:i}=e;const a=(0,r.useRef)(),l=(0,r.useRef)(),c=(0,r.useRef)(0),u=(0,r.useRef)(0),{scene:d}=(0,_.p)(t),m=(0,r.useMemo)(()=>d.clone(!0),[d]);(0,r.useEffect)(()=>{if(!l.current)return;const e=l.current,t=(new C.Box3).setFromObject(e),n=t.getCenter(new C.Vector3),r=t.getSize(new C.Vector3);e.position.sub(n);const o=Math.max(r.x,r.y,r.z),s=o>0?2/o:1;e.scale.setScalar(s),null===i||void 0===i||i()},[i,m]);const p=(0,r.useMemo)(()=>{const e=[];return m.traverse(t=>{if(t.isMesh&&t.morphTargetDictionary){var n,r,o;const i=null!==(n=null!==(r=null!==(o=t.morphTargetDictionary.MouthOpen)&&void 0!==o?o:t.morphTargetDictionary.mouthOpen)&&void 0!==r?r:t.morphTargetDictionary.O)&&void 0!==n?n:t.morphTargetDictionary.viseme_O;"number"===typeof i&&e.push({mesh:t,index:i})}}),e},[m]),h=(0,r.useMemo)(()=>{const e=[];return m.traverse(t=>{t.isMesh&&t.material&&t.material.color&&e.push(t.material)}),e},[m]),f={calm:new C.Color("#10b981"),energetic:new C.Color("#f59e0b"),neutral:new C.Color("#38bdf8")};return(0,b.F)((e,t)=>{c.current+=t;const r=C.MathUtils.clamp(n,0,1);u.current=C.MathUtils.damp(u.current,r,12,t);const i=.05*Math.sin(.4*c.current),s=.015*Math.sin(.7*c.current),l=u.current>.25?.02:0;a.current&&(a.current.rotation.y=C.MathUtils.damp(a.current.rotation.y,i,6,t),a.current.rotation.x=C.MathUtils.damp(a.current.rotation.x,s+l,6,t)),p.forEach(e=>{let{mesh:t,index:n}=e;t.morphTargetInfluences[n]=u.current});const d=f[o]||f.neutral;h.forEach(e=>{e.emissive=d.clone().multiplyScalar(.4)})}),(0,s.jsx)("group",{ref:a,position:[0,1.05,0],children:(0,s.jsx)("primitive",{ref:l,object:m,dispose:null})})}function P(){return(0,s.jsx)(w.E,{center:!0,children:(0,s.jsx)("div",{className:"flex h-32 w-32 items-center justify-center rounded-3xl border border-white/10 bg-white/5 text-xs text-white/80 backdrop-blur",children:"Loading avatar\u2026"})})}function N(e){let{gltfPath:t=T,mouthOpen:n=0,mood:o="neutral",onLoaded:i,isVisible:a=!0,onError:l}=e;return(0,s.jsx)("div",{className:"relative mx-auto flex-none h-72 w-full max-w-[340px] overflow-hidden rounded-3xl border border-white/15 bg-black/40 cursor-grab active:cursor-grabbing sm:h-80 lg:h-96",children:a&&(0,s.jsxs)(A.Hl,{camera:{position:[0,1.8,4],fov:32},children:[(0,s.jsx)("ambientLight",{intensity:.4}),(0,s.jsx)("directionalLight",{position:[2,4,2],intensity:.9}),(0,s.jsx)(k,{fallback:(0,s.jsx)(P,{}),onError:()=>{null===l||void 0===l||l()},children:(0,s.jsx)(r.Suspense,{fallback:(0,s.jsx)(P,{}),children:t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(S,{gltfPath:t,mouthOpen:n,mood:o,onLoaded:i}),(0,s.jsx)(y.OH,{preset:"sunset"})]}):(0,s.jsx)(R,{mouthOpen:n,mood:o})})}),(0,s.jsx)(E.N,{enableZoom:!1,enablePan:!1,enableRotate:!0,target:[0,1,0],minPolarAngle:Math.PI/3.2,maxPolarAngle:Math.PI-Math.PI/3.2})]})})}function R(e){let{mouthOpen:t,mood:n}=e;const o=(0,r.useRef)(),i=(0,r.useRef)(),a=(0,r.useRef)(),l=(0,r.useRef)(0),c={calm:"#10b981",energetic:"#f59e0b",neutral:"#38bdf8"},u=new C.Color(c[n]||c.neutral);return(0,b.F)((e,n)=>{l.current+=n;const r=1+.2*t+.05*Math.sin(2*l.current);if(o.current&&(o.current.scale.setScalar(.85*r),o.current.rotation.y+=.4*n),i.current&&(i.current.rotation.z+=.6*n),a.current){const e=.4+.4*t;a.current.material.emissiveIntensity=e}}),(0,s.jsxs)("group",{children:[(0,s.jsxs)("mesh",{ref:a,position:[0,1.1,0],children:[(0,s.jsx)("sphereGeometry",{args:[.95,64,64]}),(0,s.jsx)("meshStandardMaterial",{color:u.clone().multiplyScalar(.6),emissive:u,transparent:!0,opacity:.4})]}),(0,s.jsxs)("mesh",{ref:o,position:[0,1.1,0],children:[(0,s.jsx)("icosahedronGeometry",{args:[.9,1]}),(0,s.jsx)("meshStandardMaterial",{color:"#111827",emissive:u.clone().multiplyScalar(.5),metalness:.2,roughness:.1})]}),(0,s.jsxs)("mesh",{ref:i,position:[0,1.1,0],rotation:[Math.PI/2,0,0],children:[(0,s.jsx)("torusGeometry",{args:[1.05,.07,32,128]}),(0,s.jsx)("meshStandardMaterial",{color:u.clone().multiplyScalar(1.2),emissive:u,metalness:.4,roughness:.2})]}),(0,s.jsx)("pointLight",{position:[0,2.4,0],intensity:.8,color:u,distance:8})]})}T&&_.p.preload(T);class k extends r.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e){var t,n;console.warn("[coach3d] avatar failed to load",e),null===(t=(n=this.props).onError)||void 0===t||t.call(n,e)}render(){return this.state.hasError?this.props.fallback||null:this.props.children}}const j=()=>{if("undefined"!==typeof window)return window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition};const I={fr:[{id:"greetings",keywords:["bonjour","salut","coucou","hey","hello","bonsoir"],reply:"Hey ! Ravi de te retrouver. On s\u2019attaque \xe0 quoi aujourd\u2019hui : staking, roadmap, mindset ou tu veux que je te propose une mini routine ?",mood:"energetic",intention:"supportive"},{id:"identity",keywords:["qui es-tu","tu es qui","coach ia","assistant","tu fais quoi"],reply:"Je suis l\u2019IA propri\xe9taire d\u2019ACI Meta Coach. J\u2019\xe9coute ta voix, je sens ton \xe9nergie et j\u2019ajuste ton plan pour que tu progresse sans te griller. Bref, je suis ton coach perso dispo 24/7.",mood:"neutral",intention:"clarifying focus"},{id:"ecosystem-overview",keywords:["ecosysteme","\xe9co","plateforme","aci","meta coach","fonctionnement","vision","mission"],reply:"Imagine l\u2019\xe9cosyst\xe8me ACI comme un circuit en trois temps : le token t\u2019ouvre les portes, je t\u2019accompagne en live et les parcours te font monter en puissance. \xc0 chaque progression, je te d\xe9bloque des modules adapt\xe9s et ton dashboard s\u2019actualise avec l\u2019XP, les rewards et les prochaines actions.",mood:"energetic",intention:"clarifying focus"},{id:"training-engine",keywords:["plan","entra\xeenement","entrainement","routine","performance","analyse","progression","coach"],reply:"Je scrute ton stress, ta confiance et ton rythme. Si je sens que tu forces, je te glisse une respiration guid\xe9e ; si tu es dans le flow, je te propose un module plus costaud. Mon but : piloter ton entra\xeenement en live, exactement comme un coach humain.",mood:"energetic",intention:"motivating"},{id:"training-catalog",keywords:["formation","formations","programme","programmes","cours","module","modules","apprentissage","education","training"],reply:"Nos formations sont class\xe9es par niveaux : fondamentaux du trading, strat\xe9gies avanc\xe9es, psychologie et routines \xe9motionnelles. Dis-moi o\xf9 tu en es, je t\u2019indique la prochaine \xe9tape et je peux m\xeame ajouter la session \xe0 ton plan du jour.",mood:"supportive",intention:"clarifying focus"},{id:"presale-overview",keywords:["pr\xe9vente","presale","acheter","token","allocation","vente"],reply:"Pour participer \xe0 la pr\xe9vente, tu connectes ton wallet, tu choisis la tranche encore dispo et je t\u2019envoie une alerte si le palier se remplit trop vite. Une fois valid\xe9, ton allocation appara\xeet dans ton dashboard et je te tiens inform\xe9 du calendrier de distribution.",mood:"neutral",intention:"supportive"},{id:"staking-utility",keywords:["staking","staker","apy","rewards","rendement","lock","verrouillage"],reply:"Quand tu stakes ton ACI, tu touches des rewards mais tu d\xe9bloques aussi des modules premium, des remises et des priorit\xe9s sur les ventes. Je garde ton solde \xe0 l\u2019\u0153il et je te pr\xe9viens d\xe8s qu\u2019il faut r\xe9clamer ou ajuster ta position.",mood:"neutral",intention:"motivating"},{id:"tiers-benefits",keywords:["tiers","paliers","avantages","levels","packs","badge"],reply:"Les tiers ACI, c\u2019est comme des badges de progression : plus tu montes, plus tu d\xe9bloques des analyses pointues, des lives priv\xe9s et m\xeame des sessions avec les coachs humains. Dis-moi ton objectif et je te guiderai vers le palier le plus utile.",mood:"energetic",intention:"supportive"},{id:"marketplace",keywords:["marketplace","modules","formations","r\xe9compenses","recompenses","missions"],reply:"La marketplace, c\u2019est notre terrain de jeu : routines IA, masterclass, outils\u2026 Tu peux payer en ACI (avec une r\xe9duction selon ton tier) ou avec les rewards gagn\xe9s. Chaque achat me donne des infos pour ajuster ton plan derri\xe8re le rideau.",mood:"energetic",intention:"clarifying focus"},{id:"tokenomics",keywords:["tokenomics","allocation","distribution","supply","offre","r\xe9partition"],reply:"C\xf4t\xe9 tokenomics, on ventile le supply pour financer l\u2019IA, r\xe9compenser les stakers et garder de la liquidit\xe9. Plus tu joues le jeu (staking, missions), plus tu gagnes de l\u2019influence et tu vois ce qui arrive pour la gouvernance.",mood:"neutral",intention:"clarifying focus"},{id:"roadmap",keywords:["roadmap","feuille de route","prochaines \xe9tapes","plan futur"],reply:"La roadmap avance en trois temps : Alpha pour lancer le coach voix et le staking pilote, Beta pour ouvrir la marketplace et sortir l\u2019app mobile, puis Growth pour basculer en DAO, signer des partenariats pro et ouvrir nos API. Je te ping d\xe8s qu\u2019une \xe9tape te concerne directement.",mood:"energetic",intention:"motivating"},{id:"governance-roadmap",keywords:["gouvernance","vote","roadmap","avenir","future","future"],reply:"L\u2019ACI ouvrira la gouvernance communautaire : votes sur les nouveaux modules, choix des partenaires et allocation du fonds communautaire. Les jalons : pr\xe9vente, plateforme d\u2019entra\xeenement, marketplace, puis DAO. Je te tiendrai au courant des votes o\xf9 ton staking compte.",mood:"neutral",intention:"motivating"},{id:"emotion-trading-stress",keywords:["stress","peur","angoisse","\xe9motion","\xe9motions","perdre","perte","panic"],reply:"Ok respire avec moi : inspire 4 temps, garde l\u2019air 2, expire 6. Note la situation exacte qui d\xe9clenche la tension et une action que tu contr\xf4les pour la prochaine session. On pilote ton plan, pas tes peurs. Je reste l\xe0 pour recalibrer ta routine.",mood:"calm",intention:"soothing"},{id:"emotion-trading-confidence",keywords:["doute","confiance","motivation","objectif","discipline","blocage"],reply:"Je suis ton meilleur alli\xe9 : rappelle-toi ta derni\xe8re ex\xe9cution propre, liste ce qui a march\xe9 et visualise la prochaine \xe9tape. Je t\u2019envoie un d\xe9fi court ou un module mindset pour relancer la dynamique. Ensemble on garde ton intention align\xe9e.",mood:"energetic",intention:"motivating"},{id:"support-contact",keywords:["support","contact","aide","probl\xe8me","issue","bug","question"],reply:"Besoin d\u2019un humain ? support@aci-meta.coach ou le chat officiel sont l\xe0. Dis-moi aussi ce qui bloque : je logge l\u2019info pour la team et je te propose un contournement en attendant.",mood:"neutral",intention:"supportive"}],en:[{id:"greetings",keywords:["hello","hi","hey","yo","what\u2019s up","bonjour","salut"],reply:"Hey there! I\u2019m glad you\u2019re here. Fancy a chat about staking, roadmap, mindset drills, or should I spin up a quick routine for you?",mood:"energetic",intention:"supportive"},{id:"identity",keywords:["who are you","what are you","coach ai","assistant","what do you do"],reply:"I\u2019m the proprietary ACI Meta Coach AI. I listen to your voice, catch the emotional cues, and tweak your plan so you grow without burning out. Basically, I\u2019m your on-call training partner.",mood:"neutral",intention:"clarifying focus"},{id:"ecosystem-overview",keywords:["ecosystem","platform","aci","meta coach","how it works","vision","mission"],reply:"Picture the ACI ecosystem as a three-part loop: the token opens the door, I stay by your side in real time, and the training tracks push you forward. Every time you level up I unlock new modules and your dashboard refreshes with XP, rewards and next moves.",mood:"energetic",intention:"clarifying focus"},{id:"training-engine",keywords:["training","plan","routine","performance","analysis","progress","coach"],reply:"I keep tabs on your stress, confidence and tempo. If you\u2019re pushing too hard I\u2019ll slide in a breathing drill; if you\u2019re in the zone I\u2019ll surface a tougher module. Think of me as the coach who adjusts the plan while you\u2019re in motion.",mood:"energetic",intention:"motivating"},{id:"training-catalog",keywords:["training","course","courses","formation","program","programs","module","modules","curriculum","lessons"],reply:"The training catalogue is layered: trading fundamentals, advanced strategies, mindset drills, emotional routines. Tell me your current level and I\u2019ll pull the next module\u2014or drop it straight into your schedule for today.",mood:"supportive",intention:"clarifying focus"},{id:"presale-overview",keywords:["presale","pre-sale","buy","token","allocation","sale"],reply:"For the presale, just connect your wallet, pick the live tier and I\u2019ll nudge you if the tranche is filling up. Once it\u2019s locked, your allocation pops up on the dashboard and I keep you posted on the distribution timeline.",mood:"neutral",intention:"supportive"},{id:"staking-utility",keywords:["staking","stake","rewards","apy","yield","lock","locked"],reply:"When you stake ACI you earn rewards, sure, but you also unlock premium modules, discounts and early access on drops. I keep an eye on your balance and ping you when it\u2019s time to claim or rebalance.",mood:"neutral",intention:"motivating"},{id:"tiers-benefits",keywords:["tiers","levels","benefits","packs","badges"],reply:"ACI tiers work like progression badges: the higher you go, the more advanced analytics, private live rooms and human mentor sessions you unlock. Tell me what you\u2019re chasing and I\u2019ll point you to the tier that fits.",mood:"energetic",intention:"supportive"},{id:"marketplace",keywords:["marketplace","modules","courses","rewards","missions","store"],reply:"The marketplace is our playground: AI routines, masterclasses, pro tools. Pay in ACI (tier discounts apply) or with the rewards you\u2019ve earned. Each purchase gives me new signals to fine-tune your plan.",mood:"energetic",intention:"clarifying focus"},{id:"tokenomics",keywords:["tokenomics","allocation","distribution","supply"],reply:"Tokenomics-wise, ACI funds the coach, rewards the community and keeps liquidity healthy. Presale, R&D treasury, staking rewards \u2014 the more you engage, the more benefits and governance visibility you earn.",mood:"neutral",intention:"clarifying focus"},{id:"roadmap",keywords:["roadmap","next steps","milestones","plan"],reply:"Our roadmap moves in three beats: Alpha to launch the voice coach and staking pilot, Beta to open the marketplace and ship the mobile app, then Growth for DAO rollout, pro partnerships and community APIs. I\u2019ll ping you when a milestone touches your plan.",mood:"energetic",intention:"motivating"},{id:"governance-roadmap",keywords:["governance","vote","roadmap","future","dao"],reply:"ACI will unlock community governance: token holders vote on new modules, partners and treasury allocation. Milestones: presale, training platform, marketplace, then DAO roll-out. I\u2019ll notify you whenever a vote needs your staking power.",mood:"neutral",intention:"motivating"},{id:"emotion-trading-stress",keywords:["stress","fear","panic","emotion","loss","losing","anxiety"],reply:"Alright friend, breathe with me: inhale 4, hold 2, exhale 6. Capture the specific trigger and one action you control next time. We stick to the plan, not the panic. I\u2019ll keep tailoring your routine to rebuild calm.",mood:"calm",intention:"soothing"},{id:"emotion-trading-confidence",keywords:["doubt","confidence","motivation","focus","discipline","block"],reply:"I\u2019m at your side: recall your last clean execution, list what worked, and anchor your next step on that. I\u2019ll drop a short mindset drill or module to reignite the momentum. We stay aligned with your intention.",mood:"energetic",intention:"motivating"},{id:"support-contact",keywords:["support","contact","help","issue","problem","bug","question"],reply:"Need a human touch? Ping support@aci-meta.coach or the official chat. Tell me here as well: I\u2019ll log it for the team and suggest a workaround meanwhile.",mood:"neutral",intention:"supportive"}]},D=/[\u0300-\u036f]/g,L=e=>e.normalize("NFD").replace(D,"").toLowerCase();const O={emotion:"neutral",arousal:0,valence:0,stressScore:0},M={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_WALLETCONNECT_PROJECT_ID:"TON_PROJECT_ID_ICI",REACT_APP_PRESALE_CONTRACT_ADDRESS:"0x8257194Ae124EDEA0E434a3D1479e52C5a5C59C4",REACT_APP_PRESALE_CHAIN_ID:"1",REACT_APP_PRESALE_MIN_ETH:"0.01",REACT_APP_PRESALE_MAX_ETH:"50",REACT_APP_PRESALE_STATS_ENDPOINT:"",REACT_APP_PRESALE_NETWORK_LABEL:"Ethereum Mainnet",REACT_APP_PRESALE_RPC_URL:"",REACT_APP_ANALYTICS_ID:"",REACT_APP_STAKING_CONTRACT_ADDRESS:"0xF7dc4A9A7d4b3D989295C76E5ace1fA390bb5e03",REACT_APP_STAKING_TOKEN_ADDRESS:"",REACT_APP_STAKING_CHAIN_ID:"1",REACT_APP_STAKING_MIN_AMOUNT:"0",REACT_APP_STAKING_NETWORK_LABEL:"Ethereum Mainnet"}.REACT_APP_ACI_AI_URL||{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_WALLETCONNECT_PROJECT_ID:"TON_PROJECT_ID_ICI",REACT_APP_PRESALE_CONTRACT_ADDRESS:"0x8257194Ae124EDEA0E434a3D1479e52C5a5C59C4",REACT_APP_PRESALE_CHAIN_ID:"1",REACT_APP_PRESALE_MIN_ETH:"0.01",REACT_APP_PRESALE_MAX_ETH:"50",REACT_APP_PRESALE_STATS_ENDPOINT:"",REACT_APP_PRESALE_NETWORK_LABEL:"Ethereum Mainnet",REACT_APP_PRESALE_RPC_URL:"",REACT_APP_ANALYTICS_ID:"",REACT_APP_STAKING_CONTRACT_ADDRESS:"0xF7dc4A9A7d4b3D989295C76E5ace1fA390bb5e03",REACT_APP_STAKING_TOKEN_ADDRESS:"",REACT_APP_STAKING_CHAIN_ID:"1",REACT_APP_STAKING_MIN_AMOUNT:"0",REACT_APP_STAKING_NETWORK_LABEL:"Ethereum Mainnet"}.REACT_APP_COACH_API_URL||null,K={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_WALLETCONNECT_PROJECT_ID:"TON_PROJECT_ID_ICI",REACT_APP_PRESALE_CONTRACT_ADDRESS:"0x8257194Ae124EDEA0E434a3D1479e52C5a5C59C4",REACT_APP_PRESALE_CHAIN_ID:"1",REACT_APP_PRESALE_MIN_ETH:"0.01",REACT_APP_PRESALE_MAX_ETH:"50",REACT_APP_PRESALE_STATS_ENDPOINT:"",REACT_APP_PRESALE_NETWORK_LABEL:"Ethereum Mainnet",REACT_APP_PRESALE_RPC_URL:"",REACT_APP_ANALYTICS_ID:"",REACT_APP_STAKING_CONTRACT_ADDRESS:"0xF7dc4A9A7d4b3D989295C76E5ace1fA390bb5e03",REACT_APP_STAKING_TOKEN_ADDRESS:"",REACT_APP_STAKING_CHAIN_ID:"1",REACT_APP_STAKING_MIN_AMOUNT:"0",REACT_APP_STAKING_NETWORK_LABEL:"Ethereum Mainnet"}.REACT_APP_AVATAR_GLTF||"https://modelviewer.dev/shared-assets/models/Astronaut.glb",F={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_WALLETCONNECT_PROJECT_ID:"TON_PROJECT_ID_ICI",REACT_APP_PRESALE_CONTRACT_ADDRESS:"0x8257194Ae124EDEA0E434a3D1479e52C5a5C59C4",REACT_APP_PRESALE_CHAIN_ID:"1",REACT_APP_PRESALE_MIN_ETH:"0.01",REACT_APP_PRESALE_MAX_ETH:"50",REACT_APP_PRESALE_STATS_ENDPOINT:"",REACT_APP_PRESALE_NETWORK_LABEL:"Ethereum Mainnet",REACT_APP_PRESALE_RPC_URL:"",REACT_APP_ANALYTICS_ID:"",REACT_APP_STAKING_CONTRACT_ADDRESS:"0xF7dc4A9A7d4b3D989295C76E5ace1fA390bb5e03",REACT_APP_STAKING_TOKEN_ADDRESS:"",REACT_APP_STAKING_CHAIN_ID:"1",REACT_APP_STAKING_MIN_AMOUNT:"0",REACT_APP_STAKING_NETWORK_LABEL:"Ethereum Mainnet"}.REACT_APP_COACH_MODEL||"aci-coach-v1",H={IDLE:"idle",LISTENING:"listening",THINKING:"thinking",SPEAKING:"speaking",ERROR:"error"},U=["calm","neutral","energetic"],q=["auto","fr","en","es","de","pt","ar"],W={fr:"fr-FR",en:"en-US",es:"es-ES",de:"de-DE",pt:"pt-PT",ar:"ar-SA"},G={fr:"fr",en:"en",es:"es",de:"de",pt:"pt",ar:"ar"},B=[{id:"stress",keywords:["stress","ango","anxi","peur","panic","tension","tendu"]},{id:"fear",keywords:["peur","craint","inqui","inqui\xe9t","risque","perdre"]},{id:"sadness",keywords:["trist","moral","d\xe9prim","lass\xe9","fatigu\xe9","\xe9puis\xe9"]},{id:"confidence",keywords:["confiance","doute","l\xe9gitim","imposteur","oser"]},{id:"motivation",keywords:["motivation","motiv\xe9","envie","d\xe9motiv","energie","fatigue"]},{id:"focus",keywords:["focus","concentr","procrastin","distra","organis"]},{id:"anger",keywords:["col\xe8re","\xe9nerv","frustr","rage","agac\xe9"]},{id:"gratitude",keywords:["merci","gratitude","remercie"]}],V={stress:{mood:"calm",intentionKey:"stress"},fear:{mood:"calm",intentionKey:"fear"},sadness:{mood:"calm",intentionKey:"sadness"},confidence:{mood:"neutral",intentionKey:"confidence"},motivation:{mood:"energetic",intentionKey:"motivation"},focus:{mood:"neutral",intentionKey:"focus"},anger:{mood:"calm",intentionKey:"anger"},gratitude:{mood:"energetic",intentionKey:"gratitude"}},J=(e,t,n,r,o)=>{var i,s,a;const l=(e||"").trim(),c=((e,t)=>{var n,r;const o=((null===e||void 0===e?void 0:e.emotion)||"neutral").toLowerCase(),i=null!==(n=null===e||void 0===e?void 0:e.stressScore)&&void 0!==n?n:0,s=null!==(r=null===e||void 0===e?void 0:e.valence)&&void 0!==r?r:0,a=t(`coach3d.conversation.emotionLabels.${o}`,{defaultValue:o});return i>.7?t("coach3d.conversation.desc.highStress"):t(s>.3?"coach3d.conversation.desc.positive":"coach3d.conversation.desc.default",{emotion:a})})(t,o),u=null!==(i=null===t||void 0===t?void 0:t.stressScore)&&void 0!==i?i:0,d=null!==(s=null===t||void 0===t?void 0:t.valence)&&void 0!==s?s:0,m=null!==(a=null===t||void 0===t?void 0:t.arousal)&&void 0!==a?a:.4,p=l.includes("?"),h=l.toLowerCase(),f="joy"===((null===t||void 0===t?void 0:t.emotion)||"").toLowerCase(),g=/\bmerci\b|\bgratitude\b/.test(h),x=(e=>{if(!e)return null;const t=e.toLowerCase(),n=B.find(e=>e.keywords.some(e=>t.includes(e)));if("gratitude"===(null===n||void 0===n?void 0:n.id)){const e=B.find(e=>"gratitude"!==e.id&&e.keywords.some(e=>t.includes(e)));return e?e.id:n.id}if(!n){if(/comment\s+(rester|garder)\s+(calme|zen)/.test(t))return"stress";if(/comment\s+(me\s+)?re(motiver|booster)/.test(t))return"motivation"}return n?n.id:null})(l),v=o(`coach3d.conversation.intro.${n}`,{returnObjects:!0}),b=o("coach3d.conversation.intro.neutral",{returnObjects:!0});let A=Array.isArray(v)&&v.length?v:null;A&&A.length||(A=Array.isArray(b)&&b.length?b:null),A&&A.length||(A=[o("coach3d.conversation.introDefault")]);const _=A[Math.floor(Math.random()*A.length)],w=((e,t,n)=>{var r,o;const i=V[e]||null,s=null!==(r=null===t||void 0===t?void 0:t.stress)&&void 0!==r?r:0,a=null!==(o=null===t||void 0===t?void 0:t.valence)&&void 0!==o?o:0,l=e?n(`coach3d.conversation.guidance.${e}`,{defaultValue:""}):"",c=e?n(`coach3d.conversation.followUp.${e}`,{defaultValue:""}):"";let u=(null===i||void 0===i?void 0:i.mood)||null;return"confidence"===e&&s>.4&&(u="calm"),"motivation"===e&&a<=.5&&(u="neutral"),{guidance:l||null,followUp:c||null,mood:u,intention:null!==i&&void 0!==i&&i.intentionKey?n(`coach3d.conversation.intentionsByIntent.${i.intentionKey}`,{defaultValue:""}):null}})(x,{desc:c,stress:u,valence:d,arousal:m},o);let y=w.guidance,E=w.followUp,C=w.mood&&U.includes(w.mood)?w.mood:n;y||(u>.6?(y=o("coach3d.conversation.guidanceFallback.stress"),C="calm"):d>.4||m>.55?(y=o("coach3d.conversation.guidanceFallback.positive"),C=d>.4?"energetic":C):f||g?(y=o("coach3d.conversation.guidanceFallback.gratitude"),C="neutral"):y=o("coach3d.conversation.guidanceFallback.default")),E||(E=o(p?"coach3d.conversation.followUpFallback.question":"coach3d.conversation.followUpFallback.statement"));const T=[];l.length>0?T.push(o(p?"coach3d.conversation.reflection.question":"coach3d.conversation.reflection.statement",{text:l})):T.push(o("coach3d.conversation.reflection.empty")),c&&T.push(o("coach3d.conversation.reflection.perception",{description:c})),r&&T.push(o("coach3d.conversation.reflection.liveSync"));const S=o("calm"===C?"coach3d.conversation.outro.calm":"energetic"===C?"coach3d.conversation.outro.energetic":"coach3d.conversation.outro.neutral"),P=[_,T.join("").trim(),y,E,S].filter(Boolean),N=w.intention||o("calm"===C?"coach3d.conversation.intentions.calm":"energetic"===C?"coach3d.conversation.intentions.energetic":"coach3d.conversation.intentions.neutral");return{reply:P.join(" ").replace(/\s+/g," ").trim(),mood:C,intention:N}},$=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.log(`[coach3d] ${e}`,t),"undefined"!==typeof window&&Array.isArray(window.dataLayer)&&window.dataLayer.push({event:e,...t})};function z(e){let{role:t,text:n}=e;const r="user"===t?"self-end bg-emerald-500/80 text-black":"self-start bg-white/10 text-white";return(0,s.jsx)("div",{className:`max-w-xs rounded-2xl px-4 py-2 text-sm leading-relaxed shadow ${r}`,children:n})}const X=e=>{if(!e)return"en";const t=e.toLowerCase();return(t.includes("-")?t.split("-")[0]:t)||"en"};function Y(e){let{emotionState:t=O,onRequestCamera:n,isEmotionStreamLive:i=!1}=e;const{t:a,i18n:l}=(0,o.Bd)(),c=(0,r.useRef)(null),[u,d]=(0,r.useState)(!0),[m,p]=(0,r.useState)(H.IDLE),[h,f]=(0,r.useState)("neutral"),[g,x]=(0,r.useState)(!1),[v,b]=(0,r.useState)(K||null),[A,_]=(0,r.useState)([]),[w,y]=(0,r.useState)(""),[E,C]=(0,r.useState)(null),[T,S]=(0,r.useState)(!1),P=(0,r.useRef)(null),[R,k]=(0,r.useState)("auto"),D=(0,r.useMemo)(()=>X(l.language),[l.language]),B=(0,r.useMemo)(()=>q.filter(e=>"auto"!==e),[]),V=(0,r.useMemo)(()=>{const e="auto"===R?D:R;return B.includes(e)?e:"en"},[B,R,D]),Y=W[V]||"en-US",Q=G[V]||null,Z=(0,r.useMemo)(()=>l.getFixedT(V),[V,l]),{sttSupported:ee,micSupported:te,permission:ne,isListening:re,interimTranscript:oe,startListening:ie,stopListening:se,requestPermission:ae,amplitude:le}=function(){let{lang:e,onFinalTranscript:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const[n]=(0,r.useState)(()=>"undefined"!==typeof window&&("SpeechRecognition"in window||"webkitSpeechRecognition"in window)),[o]=(0,r.useState)(()=>{var e;return"undefined"!==typeof navigator&&!(null===(e=navigator.mediaDevices)||void 0===e||!e.getUserMedia)}),[i,s]=(0,r.useState)("unknown"),[a,l]=(0,r.useState)(!1),[c,u]=(0,r.useState)(""),[d,m]=(0,r.useState)(""),[p,h]=(0,r.useState)(0),f=(0,r.useRef)(null),g=(0,r.useRef)(null),x=(0,r.useRef)(null),v=(0,r.useRef)(null),b=(0,r.useRef)(null),A=(0,r.useRef)(null),_=(0,r.useCallback)(()=>{A.current&&(cancelAnimationFrame(A.current),A.current=null),v.current&&(v.current.disconnect(),v.current=null),x.current&&(x.current.close().catch(()=>{}),x.current=null),g.current&&(g.current.getTracks().forEach(e=>e.stop()),g.current=null),h(0)},[]),w=(0,r.useCallback)(()=>{f.current&&(f.current.onresult=null,f.current.onerror=null,f.current.onend=null,f.current.stop(),f.current=null),_(),l(!1),u("")},[_]),y=(0,r.useCallback)(e=>{let n="",r="";for(let t=e.resultIndex;t<e.results.length;t+=1){const o=e.results[t][0].transcript;e.results[t].isFinal?r+=o:n+=o}if(n&&u(n),r){const e=r.trim();m(e),u(""),null===t||void 0===t||t(e),f.current&&f.current.stop()}},[t]),E=(0,r.useCallback)(()=>{if(!v.current||!b.current)return;v.current.getByteTimeDomainData(b.current);let e=0;for(let n=0;n<b.current.length;n+=1){const t=b.current[n]-128;e+=t*t}const t=Math.sqrt(e/b.current.length)/128;h(Math.min(2*t,1)),A.current=requestAnimationFrame(E)},[]),C=(0,r.useCallback)(async()=>{if(a)return!0;if(!o)return s("denied"),!1;try{const r=await navigator.mediaDevices.getUserMedia({audio:!0});s("granted"),g.current=r,x.current=new(window.AudioContext||window.webkitAudioContext);const o=x.current.createMediaStreamSource(r);v.current=x.current.createAnalyser(),v.current.fftSize=1024;const i=v.current.frequencyBinCount;b.current=new Uint8Array(i),o.connect(v.current),E();let a=!0;if(n){const n=j(),r=n?new n:null;if(r){r.lang=e||navigator.language||"en-US",r.interimResults=!0,r.continuous=!0,r.maxAlternatives=1,r.onresult=y,r.onerror=e=>{console.warn("[coach/audio] speech recognition error",e.error)},r.onend=()=>{l(!1),u("")};try{r.start(),f.current=r}catch(t){console.warn("[coach/audio] unable to start recognition",t),f.current=null,a=!1}}else a=!1}return!n||a?(l(!0),u(""),!0):(_(),l(!1),u(""),!1)}catch(r){return console.error("[coach/audio] microphone access denied",r),s("denied"),_(),!1}},[E,y,a,e,o,n,_]),T=(0,r.useCallback)(async()=>{if(!o)return s("denied"),!1;try{return(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(e=>e.stop()),s("granted"),!0}catch(e){return console.warn("[coach/audio] permission request failed",e),s("denied"),!1}},[o]),S=(0,r.useCallback)(()=>{m(""),u("")},[]);return(0,r.useEffect)(()=>w,[w]),{sttSupported:n,micSupported:o,permission:i,isListening:a,interimTranscript:c,currentTranscript:d,amplitude:p,requestPermission:T,startListening:C,stopListening:w,resetTranscript:S}}({lang:Y,onFinalTranscript:e=>{e&&e.trim().length>0&&be(e.trim())}}),{ttsSupported:ce,isSpeaking:ue,speak:de,cancel:me}=function(){let{lang:e,voiceHint:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=(0,r.useMemo)(()=>{if("undefined"!==typeof window)return window.speechSynthesis},[]),o=Boolean(n),[i,s]=(0,r.useState)(!1),[a,l]=(0,r.useState)([]),c=(0,r.useRef)(null),u=(0,r.useRef)(null),d=(0,r.useCallback)(()=>{c.current&&(c.current.onend=null,c.current.onstart=null,c.current.onerror=null,c.current=null),o&&null!==n&&void 0!==n&&n.speaking&&n.cancel(),s(!1)},[n,o]);(0,r.useEffect)(()=>{if(!n)return;const e=()=>{const e=n.getVoices?n.getVoices():[];l(e),u.current&&(u.current(e),u.current=null)};e();let t=null,r=null;return"function"===typeof n.addEventListener?n.addEventListener("voiceschanged",e):"onvoiceschanged"in n&&(t=n.onvoiceschanged,r=r=>{"function"===typeof t&&t.call(n,r),e()},n.onvoiceschanged=r),()=>{"function"===typeof n.removeEventListener&&n.removeEventListener("voiceschanged",e),r&&n.onvoiceschanged===r&&(n.onvoiceschanged=t||null)}},[n]);const m=(0,r.useCallback)(()=>{if(!n)return Promise.resolve([]);const e=n.getVoices?n.getVoices():[];return e.length>0?Promise.resolve(e):new Promise(e=>{u.current=e})},[n]),p=(0,r.useCallback)(function(r){let{lang:i,voiceHint:l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(async u=>{if(!o||!n)return void u(!1);d();const p=i||e||navigator.language||"en-US",h=(l||t||"").toLowerCase(),f=new SpeechSynthesisUtterance(r);f.lang=p;const g=(e=>{if(!Array.isArray(e)||0===e.length)return null;const t=e.find(e=>{var t;return e.lang&&e.lang.toLowerCase().startsWith(p.toLowerCase())&&(!h||(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(h)))});if(t)return t;const n=p.split("-")[0],r=e.find(e=>{var t;return e.lang&&e.lang.toLowerCase().startsWith(n.toLowerCase())&&(!h||(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(h)))});if(r)return r;if(h){const t=e.find(e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(h)});if(t)return t}return e[0]})(a.length?a:await m());g&&(f.voice=g),f.pitch=1.05,f.rate=.95,f.volume=.92,f.onstart=()=>{s(!0)},f.onend=()=>{s(!1),u(!0)},f.onerror=()=>{s(!1),u(!1)},c.current=f,n.speak(f)})},[d,m,e,n,o,t,a]);return{ttsSupported:o,isSpeaking:i,speak:p,cancel:d}}({lang:Y,voiceHint:Q}),[pe,he]=(0,r.useState)(0),fe=(0,r.useRef)(!1);(0,r.useEffect)(()=>{let e;const t=()=>{he((Math.sin(Date.now()/140)+1)/2),e=requestAnimationFrame(t)};return ue?(t(),fe.current||$("tts_started"),fe.current=!0):(e&&cancelAnimationFrame(e),he(0),fe.current&&$("tts_finished"),fe.current=!1),()=>{e&&cancelAnimationFrame(e)}},[ue]),(0,r.useEffect)(()=>{$("coach3d_opened",{locale:l.language})},[l.language]),(0,r.useEffect)(()=>{S(!1)},[v]),(0,r.useEffect)(()=>{$(i?"emotion_stream_live_on":"emotion_stream_live_off")},[i]),(0,r.useEffect)(()=>{const e=new IntersectionObserver(e=>{e.forEach(e=>{d(e.isIntersecting)})},{threshold:.15}),t=c.current;return t&&e.observe(t),()=>{t&&e.unobserve(t)}},[]),(0,r.useEffect)(()=>{u||(se(),me(),p(H.IDLE))},[me,u,se]),(0,r.useEffect)(()=>{ue?(p(H.SPEAKING),se()):m===H.SPEAKING&&p(H.IDLE)},[ue,m,se]);const ge=(0,r.useMemo)(()=>{var e,n,r;const o=null!==(e=null===t||void 0===t?void 0:t.stressScore)&&void 0!==e?e:0,i=null!==(n=null===t||void 0===t?void 0:t.valence)&&void 0!==n?n:0,s=null!==(r=null===t||void 0===t?void 0:t.arousal)&&void 0!==r?r:.4;return o>.55?"calm":i>.5||s>.65?"energetic":"neutral"},[t]);(0,r.useEffect)(()=>{f(ge),$("avatar_mood_set",{mood:ge})},[ge]);const[xe,ve]=(0,r.useState)(!0),be=(0,r.useCallback)(async e=>{se(),_(t=>[...t,{id:`user-${Date.now()}`,role:"user",text:e}]),p(H.THINKING),$("stt_done",{text:e});try{let u;const d=function(e){let{text:t,lang:n}=e;if(!t)return null;const r=I[n]||I.en,o=L(t),i=r.find(e=>e.keywords.some(e=>o.includes(L(e))));return i?{reply:i.reply,mood:i.mood,intention:i.intention}:null}({text:e,lang:V});if(M)try{var n,r,o,s;const i={model:F,input:e,lang:Y,emotion:null!==(n=null===t||void 0===t?void 0:t.emotion)&&void 0!==n?n:"neutral",stressScore:null!==(r=null===t||void 0===t?void 0:t.stressScore)&&void 0!==r?r:0,arousal:null!==(o=null===t||void 0===t?void 0:t.arousal)&&void 0!==o?o:0,valence:null!==(s=null===t||void 0===t?void 0:t.valence)&&void 0!==s?s:0},a=await fetch(M,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!a.ok)throw new Error(`coach_api_${a.status}`);u=await a.json()}catch(l){console.warn("[coach3d] aci ai service failed, falling back to local reply",l)}u||(u=d?{reply:d.reply,mood:d.mood&&U.includes(d.mood)?d.mood:ge,intention:d.intention||"clarifying focus"}:J(e,t,ge,i,Z));const m=u.reply||u.text||a("coach3d.error.generic"),h=u.mood&&U.includes(u.mood)?u.mood:ge;if(_(e=>[...e,{id:`coach-${Date.now()}`,role:"coach",text:m}]),f(h),$("ai_reply",{text:m,mood:h}),p(ce?H.SPEAKING:H.IDLE),ce)try{await de(m,{lang:Y,voiceHint:Q||void 0})}catch(c){console.warn("[coach3d] tts failed",c)}p(H.IDLE)}catch(l){console.error("[coach3d] error",l),C(a("coach3d.error.generic")),p(H.ERROR),ve(!1),setTimeout(()=>{C(null),p(H.IDLE),ve(!0)},4e3)}},[Z,ge,V,t,i,Y,Q,de,a,ce]),Ae=ue?pe:re?Math.min(2*le,1):.05;return(0,s.jsxs)("div",{ref:c,className:"mt-8 rounded-3xl border border-white/15 bg-white/5 p-6 text-white shadow-2xl backdrop-blur",children:[(0,s.jsx)("div",{className:"sr-only","aria-live":"polite",children:oe}),(0,s.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-baseline sm:justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold",children:a("coach3d.title")}),(0,s.jsx)("p",{className:"mt-1 text-sm text-white/70 leading-relaxed",children:a("coach3d.subtitle")})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 text-xs text-white/60",children:[(0,s.jsx)("span",{className:"rounded-full bg-white/10 px-3 py-1 uppercase tracking-widest",children:a(`coach3d.state.${m}`)}),(0,s.jsx)("span",{className:"rounded-full border px-3 py-1 uppercase tracking-widest transition "+(i?"border-emerald-400/40 bg-emerald-500/10 text-emerald-200":"border-white/10 bg-white/5 text-white/35"),children:a(i?"coach3d.liveEmotionOn":"coach3d.liveEmotionOff")}),(0,s.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-full border border-white/15 bg-white/5 px-3 py-1 text-[11px] uppercase tracking-[0.2em] text-white/60",children:[(0,s.jsx)("span",{className:"sr-only",children:a("coach3d.language.label")}),(0,s.jsxs)("select",{value:R,onChange:e=>{const t=e.target.value;k(q.includes(t)?t:"auto")},className:"bg-transparent text-xs font-semibold uppercase outline-none focus-visible:ring-0",children:[(0,s.jsx)("option",{value:"auto",children:a("coach3d.language.auto")}),(0,s.jsx)("option",{value:"fr",children:a("coach3d.language.options.fr")}),(0,s.jsx)("option",{value:"en",children:a("coach3d.language.options.en")}),(0,s.jsx)("option",{value:"es",children:a("coach3d.language.options.es")}),(0,s.jsx)("option",{value:"de",children:a("coach3d.language.options.de")}),(0,s.jsx)("option",{value:"pt",children:a("coach3d.language.options.pt")}),(0,s.jsx)("option",{value:"ar",children:a("coach3d.language.options.ar")})]})]})]})]}),T&&(0,s.jsx)("div",{className:"mt-4 rounded-2xl border border-amber-400/40 bg-amber-500/10 p-3 text-xs text-amber-200",children:a("coach3d.error.avatarLoad")}),!ee&&(0,s.jsx)("div",{className:"mt-4 rounded-2xl border border-amber-400/40 bg-amber-500/10 p-3 text-xs text-amber-200",children:a("coach3d.error.sttUnsupported")}),!ce&&(0,s.jsx)("div",{className:"mt-3 rounded-2xl border border-blue-400/40 bg-blue-500/10 p-3 text-xs text-blue-200",children:a("coach3d.error.ttsUnsupported")}),E&&(0,s.jsx)("div",{className:"mt-3 rounded-2xl border border-rose-500/50 bg-rose-500/10 p-3 text-xs text-rose-200",children:E}),(0,s.jsxs)("div",{className:"mt-6 flex flex-col gap-6 lg:flex-row lg:items-start",children:[(0,s.jsx)("div",{className:"flex w-full flex-col items-start gap-4 self-start lg:max-w-[380px]",children:(0,s.jsxs)("div",{className:"w-full sm:w-auto",children:[!g&&!T&&(0,s.jsx)("div",{className:"absolute inset-0 animate-pulse rounded-3xl border border-white/10 bg-white/10"}),(0,s.jsx)(N,{gltfPath:v,mood:h,mouthOpen:Ae,onLoaded:()=>x(!0),isVisible:u,onError:()=>{S(!0),b(null)}})]})}),(0,s.jsxs)("div",{className:"flex flex-1 flex-col gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,s.jsx)("button",{onClick:ae,className:"rounded-full border border-white/20 px-4 py-2 text-sm text-white hover:bg-white/10 disabled:opacity-50",disabled:!te||"granted"===ne,children:a("coach3d.enableMic")}),(0,s.jsx)("button",{onClick:async()=>{$("coach3d_camera_clicked");try{var e;if(null===(e=navigator.mediaDevices)||void 0===e||!e.getUserMedia)throw new Error("unsupported");if(P.current)return P.current.getTracks().forEach(e=>e.stop()),P.current=null,void C(null);const t=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});P.current=t,C(null)}catch(t){console.warn("[coach3d] camera error",t),C(a("coach3d.error.cameraUnavailable")),setTimeout(()=>C(null),3e3)}},className:"rounded-full border border-white/20 px-4 py-2 text-sm text-white hover:bg-white/10",children:a("coach3d.enableCam")}),(0,s.jsx)("button",{onClick:async()=>{if(ue)return;if(!ee){$("coach3d_stt_fallback");const e=window.prompt(a("coach3d.promptFallback"),"");return void(e&&e.trim()&&be(e.trim()))}if(re)return se(),void p(H.IDLE);if("granted"!==ne){if(!await ae())return}if(await ie())$("mic_started"),p(H.LISTENING);else{const e=window.prompt(a("coach3d.promptFallback"),"");e&&e.trim()&&be(e.trim())}},className:"rounded-full bg-emerald-500 px-4 py-2 text-sm font-semibold text-black transition hover:bg-emerald-400 disabled:cursor-not-allowed disabled:opacity-60",disabled:"denied"===ne||!te||ue||!xe,"aria-pressed":re,children:a(re?"coach3d.listening":"coach3d.talkToCoach")})]}),"denied"===ne&&(0,s.jsx)("p",{className:"rounded-2xl border border-rose-500/50 bg-rose-500/10 px-4 py-2 text-xs text-rose-200",children:a("coach3d.error.microDenied")}),(0,s.jsx)("div",{className:"flex h-64 flex-shrink-0 flex-col gap-3 overflow-hidden rounded-2xl border border-white/10 bg-black/30 p-4",children:(0,s.jsxs)("div",{className:"flex flex-col gap-2 overflow-y-auto pr-2",children:[0===A.length&&(0,s.jsx)("p",{className:"text-xs text-white/50",children:a("coach3d.noConversation")}),A.map(e=>(0,s.jsx)(z,{role:e.role,text:e.text},e.id))]})}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t=w.trim();t&&(y(""),be(t))},className:"flex flex-shrink-0 gap-2 rounded-2xl border border-white/10 bg-black/30 p-3",children:[(0,s.jsx)("input",{type:"text",value:w,onChange:e=>y(e.target.value),className:"flex-1 rounded-full bg-black/40 px-3 py-2 text-sm text-white placeholder-white/30 focus:outline-none focus:ring-2 focus:ring-emerald-500/50",placeholder:a("coach3d.manualPlaceholder")}),(0,s.jsx)("button",{type:"submit",className:"rounded-full bg-emerald-500 px-4 py-2 text-sm font-semibold text-black hover:bg-emerald-400",children:a("coach3d.send")})]})]})]})]})}function Q(){const{t:e}=(0,o.Bd)(),[t,n]=(0,r.useState)(null),[a,l]=(0,r.useState)(!1),c=(0,r.useMemo)(()=>{if(t)return{...t}},[t]);return(0,s.jsxs)("div",{className:"py-20",children:[(0,s.jsxs)("div",{className:"mb-12 text-center text-white",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold sm:text-5xl",children:e("coachIAPage.title")}),(0,s.jsx)("p",{className:"mx-auto mt-4 max-w-2xl text-base text-white/70 leading-relaxed",children:e("coachIAPage.intro")})]}),(0,s.jsx)(i.A,{variant:"page"}),(0,s.jsx)(v,{onEmotionStateChange:n,onSessionToggle:l}),(0,s.jsx)(Y,{emotionState:c,isEmotionStreamLive:a})]})}},63309:(e,t,n)=>{n.d(t,{A:()=>s});n(9950);var r=n(67818),o=n(24492),i=n(44414);function s(e){let{variant:t="page"}=e;const n="home"===t,{t:s}=(0,r.Bd)(),a=s("coachIASection.bullets",{returnObjects:!0})||[],l=s("coachIASection.cta",{returnObjects:!0})||{};return(0,i.jsxs)("section",{className:"relative overflow-hidden "+(n?"py-16":"py-20"),children:[(0,i.jsx)("div",{className:"absolute inset-0 -z-10 bg-gradient-to-br from-emerald-600/10 via-black/70 to-black/90"}),(0,i.jsxs)("div",{className:"relative z-10 mx-auto max-w-4xl text-white",children:[(0,i.jsxs)("div",{className:"text-center space-y-6",children:[(0,i.jsx)("p",{className:"text-sm uppercase tracking-[0.4em] text-emerald-300/80",children:s("coachIASection.badge")}),(0,i.jsx)("h2",{className:(n?"text-3xl md:text-4xl":"text-4xl md:text-5xl")+" font-bold text-balance",children:s("coachIASection."+(n?"titleHome":"titlePage"))}),(0,i.jsx)("p",{className:"text-lg text-white/70 leading-relaxed",children:s("coachIASection.subtitle")})]}),(0,i.jsx)("div",{className:"mt-12 grid gap-6 sm:grid-cols-2",children:a.map(e=>(0,i.jsx)("div",{className:"rounded-3xl border border-emerald-500/30 bg-black/60 p-6 shadow-xl shadow-emerald-500/10 backdrop-blur",children:(0,i.jsx)("p",{className:"text-sm leading-relaxed text-white/80",children:e})},e))}),(0,i.jsxs)("div",{className:"mt-12 flex flex-col items-center gap-4 sm:flex-row sm:justify-center",children:[(0,i.jsx)(o.N_,{to:"/contact",className:"rounded-full bg-[#10b981] px-8 py-3 text-sm font-semibold text-black transition hover:bg-[#00fff7]",children:l.contact}),(0,i.jsx)(o.N_,{to:"/token",className:"rounded-full border border-white/20 px-8 py-3 text-sm font-semibold text-white transition hover:border-[#10b981] hover:text-[#10b981]",children:l.token})]})]})]})}}}]);